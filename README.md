# Earthquake API

## How to run

1. Clone this repository
2. Run the API with script `./start-dev-local.sh` (you may get permission error, if you do use `chmod u+x start-dev-local.sh`)
3. Enter GraphQL playground `http://localhost:3000/graphql`
4. In 5 seconds after starting the app a synchronization will run, you will see the log: `Earthquakes synchronization started`, it may take a few seconds until the process is finished
5. There's a cron job that triggers every day at midnight to synchronize new earthquake entries with the database.
6. You may use the following query in GraphQL Playground to list the entries:

```
query ListEarthquakes {
  earthquakes {
    total
    entries {
      id
      time
      title
      state
      country
    }
  }
}

```

## Notes

1. Countries and states use autogenerated faker data - they are saved together with the earthquake data from the external api.
   Another option would be to parse the `title` field from the external API and execute comparison on that.
   External API returns geolocation data in form of squares or circles so in real application Google Maps API could be used to resolve Country/State based on that information and update the entries in the database using asynchronous queue.
   As an another option, the geolocation data could be sent from the frontend instead.

2. You may filter earthquakes by date, country and state. The last two fields are simple strings

3. You may update earthquake entries identifying them by their ID

4. Synchronization on init follows simple thought process assuming the app runs as a single instance. In case of distributed environments we could use an asynchronous queue backed by Redis, for example, to ensure the task is not being ran concurrently multiple times

5. All earthquake properties available in the external API are exposed in GraphQL
